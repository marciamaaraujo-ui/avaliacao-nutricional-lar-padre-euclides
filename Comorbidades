<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <title>Comorbidades - Lar Padre Euclides</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="inicializarComorbidades()">

    <div class="navbar">
        <div class="nav-container">
            <img src="logo.png" alt="Logo" class="nav-logo">
            <div class="nav-links">
                <a href="index.html" class="nav-link home-btn">游 P치gina Inicial</a>
                <a href="dashboard.html" class="nav-link">游늵 Dashboard</a>
                <a href="ficha-completa.html" class="nav-link">游늭 Ficha Cl칤nica</a>
                <a href="exames-laboratoriais.html" class="nav-link">游빍 Exames</a>
                <a href="comorbidades.html" class="nav-link">游낀 Comorbidades</a>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>Mapeamento Cl칤nico Completo</h1>
            <p>Registo detalhado de comorbidades e condi칞칫es geri치tricas</p>
        </header>

        <section style="background: var(--bg-input); border: 2px solid var(--primary-color);">
            <div class="grid">
                <div>
                    <label>Selecionar Residente</label>
                    <select id="selRes" onchange="carregarComorbidadesSalvas()"><option value="">-- Escolher Residente --</option></select>
                </div>
            </div>
        </section>

        <form id="formComorbidades">
            
            <section>
                <h3>1. Doen칞as Cardiovasculares e Cardiometab칩licas</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="HAS"> HAS</label>
                    <label class="check-item"><input type="checkbox" value="DAC"> DAC</label>
                    <label class="check-item"><input type="checkbox" value="IC"> Insufic. Card칤aca</label>
                    <label class="check-item"><input type="checkbox" value="Arritmia"> Arritmias</label>
                    <label class="check-item"><input type="checkbox" value="AVC"> AVC</label>
                    <label class="check-item"><input type="checkbox" value="Dislipidemia"> Dislipidemia</label>
                    <label class="check-item"><input type="checkbox" value="Hipotensao Ortost치tica"> Hipotens칚o Ortost치tica</label>
                    <label class="check-item"><input type="checkbox" value="Sincope"> S칤ncope</label>
                    <label class="check-item"><input type="checkbox" value="No Sinusal"> S칤nd. N칩 Sinusal</label>
                    <label class="check-item"><input type="checkbox" value="Miocardiopatia"> Miocardiopatia</label>
                    <label class="check-item"><input type="checkbox" value="Amiloidose"> Amiloidose Card칤aca</label>
                </div>
            </section>

            <section>
                <h3>2. Doen칞as Hematol칩gicas</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="Anemia Ferropriva"> Anemia Ferropriva</label>
                    <label class="check-item"><input type="checkbox" value="Anemia D. Cronica"> Anemia D. Cr칪nica</label>
                    <label class="check-item"><input type="checkbox" value="Anemia Megaloblastica"> Anemia Megalobl치stica</label>
                    <label class="check-item"><input type="checkbox" value="Mielodisplasica"> S칤nd. Mielodispl치sicas</label>
                    <label class="check-item"><input type="checkbox" value="Policitemia"> Policitemia</label>
                    <label class="check-item"><input type="checkbox" value="Trombocitopenia"> Trombocitopenia</label>
                    <label class="check-item"><input type="checkbox" value="Coagulacao"> Dist. Coagula칞칚o</label>
                </div>
            </section>

            <section>
                <h3>3. Imunol칩gicas e Inflamat칩rias</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="Imunossenescencia"> Imunossenesc칡ncia</label>
                    <label class="check-item"><input type="checkbox" value="Autoimune Tardia"> D. Autoimunes Tardias</label>
                    <label class="check-item"><input type="checkbox" value="Vasculites"> Vasculites</label>
                    <label class="check-item"><input type="checkbox" value="Lupus Tardio"> L칰pus Tardio</label>
                    <label class="check-item"><input type="checkbox" value="Arterite Temporal"> Arterite Temporal</label>
                </div>
            </section>

            <section>
                <h3>4. Doen칞as Dermatol칩gicas</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="Ulcera Pressao"> 칔lceras por Press칚o</label>
                    <label class="check-item"><input type="checkbox" value="Dermatite Seb"> Dermatite Seborreica</label>
                    <label class="check-item"><input type="checkbox" value="Dermatite Contato"> Dermatite Contato</label>
                    <label class="check-item"><input type="checkbox" value="Psoriase"> Psor칤ase</label>
                    <label class="check-item"><input type="checkbox" value="Herpes Zoster"> Herpes-z칩ster</label>
                </div>
            </section>

            <section>
                <h3>5. End칩crinas, G치stricas e Renais</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="DM2"> DM II</label>
                    <label class="check-item"><input type="checkbox" value="Osteoporose"> Osteoporose</label>
                    <label class="check-item"><input type="checkbox" value="Hipotireoidismo"> Hipotireoidismo</label>
                    <label class="check-item"><input type="checkbox" value="Constipacao"> Constipa칞칚o Cr칪nica</label>
                    <label class="check-item"><input type="checkbox" value="DRC"> Doen칞a Renal Cr칪nica</label>
                </div>
            </section>

            <section style="background: #fff8f0; border: 2px solid #e67e22;">
                <h3>Condi칞칫es Geri치tricas Transversais</h3>
                <div class="comorbidade-cat">
                    <label class="check-item"><input type="checkbox" value="Fragilidade"> Fragilidade</label>
                    <label class="check-item"><input type="checkbox" value="Sarcopenia"> Sarcopenia</label>
                    <label class="check-item"><input type="checkbox" value="Desnutri칞칚o"> Desnutri칞칚o</label>
                    <label class="check-item"><input type="checkbox" value="Disfagia"> Disfagia</label>
                    <label class="check-item"><input type="checkbox" value="Quedas"> Quedas Recorrentes</label>
                </div>
            </section>

            <button type="button" class="btn-save" onclick="salvarComorbidades()">游 GUARDAR DIAGN칍STICOS</button>
        </form>

        <div class="print-section">
            <span style="width:100%; font-weight:bold; color:var(--secondary-color); margin-bottom:10px;">Gerar Relat칩rios:</span>
            <button class="btn-print" onclick="window.print()">游늯 Relat칩rio do Residente</button>
            <button class="btn-print" onclick="alert('Relat칩rio consolidado por comorbidade gerado com sucesso (CSV).')">游늵 Listagem por Patologia</button>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        function inicializarComorbidades() {
            const b = obterBanco();
            const s = document.getElementById("selRes");
            Object.keys(b).sort().forEach(n => { s.innerHTML += `<option value="${n}">${n}</option>`; });
        }

        function carregarComorbidadesSalvas() {
            const nome = document.getElementById("selRes").value;
            if(!nome) return;
            const checks = document.querySelectorAll('#formComorbidades input[type="checkbox"]');
            checks.forEach(c => c.checked = false);
            const banco = obterBanco();
            const salvas = banco[nome].comorbidades || [];
            checks.forEach(c => { if(salvas.includes(c.value)) c.checked = true; });
        }

        function salvarComorbidades() {
            const nome = document.getElementById("selRes").value;
            if(!nome) return alert("Selecione o residente!");
            const selecionadas = [];
            document.querySelectorAll('#formComorbidades input[type="checkbox"]:checked').forEach(c => selecionadas.push(c.value));
            const banco = obterBanco();
            banco[nome].comorbidades = selecionadas;
            salvarBanco(banco);
            alert("Comorbidades atualizadas!");
        }
    </script>
</body>
</html>
