<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Exames Laboratoriais - Lar Padre Euclides</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .exam-grid { display: grid; grid-template-columns: 1fr 1fr 1.5fr; gap: 10px; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; }
        .header-exam { font-weight: bold; background: #f8f9fa; padding: 10px; border-radius: 4px; }
        .ref-value { font-size: 0.8rem; color: #666; font-style: italic; }
        .category-title { background: var(--secondary-color); color: white; padding: 8px 15px; border-radius: 4px; margin-top: 20px; }
    </style>
</head>
<body onload="carregarResidentes()">

    <div class="navbar">
        <a href="index.html">Nova Avalia√ß√£o</a>
        <a href="dashboard.html">Dashboard</a>
        <a href="exames-laboratoriais.html">Exames</a>
        <a href="ficha-completa.html">Ficha Cl√≠nica</a>
    </div>

    <div class="container">
        <header>
            <h1>Registro de Exames Laboratoriais</h1>
            <h2>Prontu√°rio Bioqu√≠mico - Lar Padre Euclides</h2>
        </header>

        <section style="background: #eef9f1;">
            <label>Selecione o Residente:</label>
            <select id="selectResidenteExame" style="font-weight:bold; margin-top:10px;">
                <option value="">-- Selecionar --</option>
            </select>
            <label style="margin-top:10px;">Data da Coleta:</label>
            <input type="date" id="dataExame">
        </section>

        <div class="exam-grid header-exam">
            <div>Exame</div>
            <div>Resultado</div>
            <div>Valor de Refer√™ncia (Idoso)</div>
        </div>

        <form id="formExames">
            <div class="category-title">Hemograma Completo</div>
            <div class="exam-grid"><div>Eritr√≥citos</div><input type="text" id="eritrocitos"> <div class="ref-value">M: 4.5-5.9 | F: 4.0-5.2 mi/mm¬≥</div></div>
            <div class="exam-grid"><div>Hemoglobina</div><input type="text" id="hemoglobina"> <div class="ref-value">M: 13.5-17.5 | F: 12.0-15.5 g/dL</div></div>
            <div class="exam-grid"><div>Hemat√≥crito</div><input type="text" id="hematocrito"> <div class="ref-value">M: 41-50% | F: 36-44%</div></div>
            <div class="exam-grid"><div>VCM / HCM</div><input type="text" id="vcm_hcm"> <div class="ref-value">VCM: 80-100 fl | HCM: 27-32 pg</div></div>
            <div class="exam-grid"><div>Leuc√≥citos</div><input type="text" id="leucocitos"> <div class="ref-value">4.000 - 11.000 /mm¬≥</div></div>
            <div class="exam-grid"><div>Plaquetas</div><input type="text" id="plaquetas"> <div class="ref-value">150.000 - 450.000 /mm¬≥</div></div>

            <div class="category-title">Prote√≠nas e Inflama√ß√£o</div>
            <div class="exam-grid"><div>Albumina S√©rica</div><input type="text" id="albumina"> <div class="ref-value">3.5 - 5.0 g/dL (Sinal de desnutri√ß√£o se < 3.5)</div></div>
            <div class="exam-grid"><div>PCR (Prote√≠na C Reativa)</div><input type="text" id="pcr"> <div class="ref-value">< 0.5 mg/dL (Marcador inflamat√≥rio)</div></div>
            <div class="exam-grid"><div>Prote√≠nas Totais</div><input type="text" id="prot_totais"> <div class="ref-value">6.0 - 8.0 g/dL</div></div>
            <div class="exam-grid"><div>Globulina</div><input type="text" id="globulina"> <div class="ref-value">2.0 - 3.5 g/dL</div></div>

            <div class="category-title">Metabolismo Glic√≠dico</div>
            <div class="exam-grid"><div>Glicemia de Jejum</div><input type="text" id="glicemia"> <div class="ref-value">70 - 99 mg/dL</div></div>
            <div class="exam-grid"><div>HbA1c (Glicada)</div><input type="text" id="hba1c"> <div class="ref-value">Risco: 5.7% - 6.4% | Diabetes: > 6.5%</div></div>

            <div class="category-title">Fun√ß√£o Renal</div>
            <div class="exam-grid"><div>Ureia</div><input type="text" id="ureia"> <div class="ref-value">15 - 45 mg/dL</div></div>
            <div class="exam-grid"><div>Creatinina</div><input type="text" id="creatinina"> <div class="ref-value">M: 0.7-1.3 | F: 0.6-1.1 mg/dL</div></div>

            <div class="category-title">Lipograma</div>
            <div class="exam-grid"><div>Colesterol Total</div><input type="text" id="col_total"> <div class="ref-value">< 190 mg/dL</div></div>
            <div class="exam-grid"><div>HDL (Bom)</div><input type="text" id="hdl"> <div class="ref-value">> 40 mg/dL</div></div>
            <div class="exam-grid"><div>LDL (Mau)</div><input type="text" id="ldl"> <div class="ref-value">< 130 mg/dL</div></div>
            <div class="exam-grid"><div>VLDL / Triglicer√≠deos</div><input type="text" id="triglic"> <div class="ref-value">< 150 mg/dL</div></div>

            <div class="category-title">Micronutrientes</div>
            <div class="exam-grid"><div>Vitamina D (25-OH)</div><input type="text" id="vit_d"> <div class="ref-value">Suficiente: > 30 ng/mL (Idosos)</div></div>
            <div class="exam-grid"><div>Vitamina B12</div><input type="text" id="vit_b12"> <div class="ref-value">200 - 900 pg/mL</div></div>
            <div class="exam-grid"><div>√Åcido F√≥lico</div><input type="text" id="folico"> <div class="ref-value">3.0 - 17.0 ng/mL</div></div>
            <div class="exam-grid"><div>Ferritina / Ferro S√©rico</div><input type="text" id="ferro"> <div class="ref-value">Ferritina: 20-250 ng/mL | Ferro: 60-170 mcg/dL</div></div>
            <div class="exam-grid"><div>Eletr√≥litos (Na, K, P, Ca, Mg, Zn)</div><input type="text" id="eletrolitos"> <div class="ref-value">S√≥dio: 135-145 | Pot√°ssio: 3.5-5.0 mEq/L</div></div>

            <div class="category-title">Hepatograma e Tireoide</div>
            <div class="exam-grid"><div>TGO (AST) / TGP (ALT)</div><input type="text" id="tgo_tgp"> <div class="ref-value">TGO: < 37 | TGP: < 41 U/L</div></div>
            <div class="exam-grid"><div>TSH (Tireoide)</div><input type="text" id="tsh"> <div class="ref-value">0.4 - 4.5 mIU/L</div></div>

            <div class="category-title">EAS (Urina Tipo 1)</div>
            <div class="exam-grid"><div>Densidade / pH / Outros</div><input type="text" id="eas"> <div class="ref-value">pH: 5.0-7.0 | Aus√™ncia de Prote√≠nas/Glicose</div></div>
        </form>

        <div class="actions">
            <button class="btn-save" onclick="processarExame()">üíæ Salvar Exames no Prontu√°rio</button>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        function carregarResidentes() {
            const banco = obterBanco();
            const select = document.getElementById("selectResidenteExame");
            Object.keys(banco).sort().forEach(nome => {
                let opt = document.createElement("option");
                opt.value = nome;
                opt.textContent = nome;
                select.appendChild(opt);
            });
        }

        function processarExame() {
            const nome = document.getElementById("selectResidenteExame").value;
            if (!nome) return alert("Selecione um residente!");

            // Mapeia todos os inputs do form
            const inputs = document.querySelectorAll('#formExames input');
            let dadosExame = {
                dataColeta: document.getElementById("dataExame").value || new Date().toLocaleDateString()
            };

            inputs.forEach(input => {
                dadosExame[input.id] = input.value;
            });

            // Chama sua fun√ß√£o do app.js
            salvarExame(nome, dadosExame);

            alert("Exames de " + nome + " registrados com sucesso!");
            if(confirm("Deseja ir para a Ficha Cl√≠nica ver o hist√≥rico?")) {
                window.location.href = "ficha-completa.html";
            }
        }
    </script>
</body>
</html>
