<!DOCTYPE html>
<html lang="pt-pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Institucional ILPI</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="renderizarDashboard()">

<div class="container">

<header style="display:flex; justify-content:space-between; align-items:center;">
<div>
<h1>Painel EpidemiolÃ³gico Institucional</h1>
<p>Indicadores automÃ¡ticos ILPI</p>
</div>

<button class="btn-save" onclick="exportarParaCSV()">
ðŸ“Š Exportar CSV
</button>
</header>

<div class="grid" style="margin-top:30px;">
<div class="stat-card">
<label>Total Residentes</label>
<p id="statTotal">0</p>
</div>

<div class="stat-card">
<label>Alto Risco ClÃ­nico</label>
<p id="statAlto">0</p>
</div>

<div class="stat-card">
<label>MÃ©dia IMC</label>
<p id="statIMC">0</p>
</div>
</div>

<canvas id="graficoRisco" style="margin-top:40px;"></canvas>
<canvas id="graficoIMC" style="margin-top:40px;"></canvas>

</div>

<script src="app.js"></script>

<script>

function renderizarDashboard() {

    const ind = calcularIndicadoresILPI();

    document.getElementById("statTotal").innerText = ind.total;
    document.getElementById("statAlto").innerText = ind.alto;
    document.getElementById("statIMC").innerText = ind.mediaIMC.toFixed(1);

    new Chart(document.getElementById("graficoRisco"), {
        type: "doughnut",
        data: {
            labels: ["Alto Risco", "Risco Moderado", "Baixo Risco"],
            datasets: [{
                data: [
                    ind.alto,
                    ind.moderado,
                    ind.total - ind.alto - ind.moderado
                ]
            }]
        }
    });

    new Chart(document.getElementById("graficoIMC"), {
        type: "bar",
        data: {
            labels: ["IMC < 22", "IMC â‰¥ 22"],
            datasets: [{
                data: [
                    ind.baixoPeso,
                    ind.total - ind.baixoPeso
                ]
            }]
        }
    });
}

</script>

</body>
</html>
