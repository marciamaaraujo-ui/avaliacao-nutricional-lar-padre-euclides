Aqui est√° o c√≥digo completo para o dashboard.html. Ele foi atualizado para ler o "Banco Central" (bancoILPI) e exibir as tr√™s classifica√ß√µes em colunas separadas (MNA, NRS e ICN), permitindo uma vis√£o r√°pida do risco de cada residente.

O c√≥digo est√° limpo e pronto para substitui√ß√£o:

HTML
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Lar Padre Euclides</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="renderizarDashboard()">

    <div class="navbar">
        <img src="logo.png" alt="Lar Padre Euclides" style="height:50px; margin-right:20px;">
        <a href="index.html">Nova Avalia√ß√£o</a>
        <a href="dashboard.html">Dashboard</a>
        <a href="ficha-completa.html">Ficha Cl√≠nica</a>
        <a href="exames-laboratoriais.html">Exames</a>
    </div>

    <div class="container" style="max-width: 1100px;">
        <header>
            <h1>Painel de Controle Nutricional</h1>
            <p>Vis√£o Geral e Estat√≠sticas do Lar Padre Euclides</p>
        </header>

        <div class="grid">
            <div style="background: #fff; padding: 20px; border-radius: 8px; border-top: 4px solid var(--primary-color); text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                <h4 style="margin:0; color: #7f8c8d; font-size: 0.9rem;">Residentes Avaliados</h4>
                <p id="statTotal" style="margin:10px 0 0; font-size: 1.8rem; font-weight: bold;">0</p>
            </div>
            <div style="background: #fff; padding: 20px; border-radius: 8px; border-top: 4px solid #e67e22; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                <h4 style="margin:0; color: #7f8c8d; font-size: 0.9rem;">Alto Risco (ICN)</h4>
                <p id="statRisco" style="margin:10px 0 0; font-size: 1.8rem; font-weight: bold; color: #e67e22;">0</p>
            </div>
            <div style="background: #fff; padding: 20px; border-radius: 8px; border-top: 4px solid var(--secondary-color); text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                <h4 style="margin:0; color: #7f8c8d; font-size: 0.9rem;">M√©dia de IMC</h4>
                <p id="statImc" style="margin:10px 0 0; font-size: 1.8rem; font-weight: bold;">0</p>
            </div>
        </div>

        <section>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3>Hist√≥rico de Residentes</h3>
                <button class="btn-save" onclick="exportarExcel()" style="width: auto; padding: 10px 20px; margin: 0;">üì• Exportar CSV (Excel)</button>
            </div>
            
            <table style="width: 100%; border-collapse: collapse; background: white;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">Residente</th>
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">Data</th>
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">MNA</th>
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">NRS-2002</th>
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">ICN (Risco)</th>
                        <th style="padding: 12px; border-bottom: 2px solid var(--primary-color); text-align: left;">A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="corpoTabela"></tbody>
            </table>
        </section>
    </div>

    <script src="app.js"></script>
    <script>
        function renderizarDashboard() {
            const banco = obterBanco();
            const corpoTabela = document.getElementById("corpoTabela");
            corpoTabela.innerHTML = "";

            let totalResidentes = 0;
            let totalAltoRisco = 0;
            let somaImc = 0;

            Object.keys(banco).sort().forEach(nome => {
                const avaliacoes = banco[nome].avaliacoes;
                if (avaliacoes.length > 0) {
                    totalResidentes++;
                    const ultima = avaliacoes[avaliacoes.length - 1];
                    
                    // Extrair dados para estat√≠sticas
                    const imc = parseFloat(ultima.imc) || 0;
                    somaImc += imc;
                    if (ultima.classIcn === "Alto Risco Cl√≠nico") totalAltoRisco++;

                    // Definir cores para os status
                    const corIcn = ultima.classIcn === "Baixo Risco" ? "#27ae60" : (ultima.classIcn === "Risco Moderado" ? "#f39c12" : "#e74c3c");

                    let linha = `
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid #eee;"><strong>${nome}</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid #eee;">${ultima.data}</td>
                            <td style="padding: 12px; border-bottom: 1px solid #eee; font-size: 0.85rem;">${ultima.mna} pts</td>
                            <td style="padding: 12px; border-bottom: 1px solid #eee; font-size: 0.85rem;">${ultima.nrs} pts</td>
                            <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                <span style="color: ${corIcn}; font-weight: bold;">${ultima.classIcn}</span>
                            </td>
                            <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                <button onclick="remover('${nome}')" style="background: none; border: none; color: #e74c3c; cursor: pointer; font-size: 0.8rem;">Excluir</button>
                            </td>
                        </tr>
                    `;
                    corpoTabela.innerHTML += linha;
                }
            });

            // Atualizar Cart√µes
            document.getElementById("statTotal").innerText = totalResidentes;
            document.getElementById("statRisco").innerText = totalAltoRisco;
            document.getElementById("statImc").innerText = totalResidentes > 0 ? (somaImc / totalResidentes).toFixed(1) : "0";
        }

        function remover(nome) {
            if (confirm(`Deseja apagar permanentemente todo o hist√≥rico de ${nome}?`)) {
                const banco = obterBanco();
                delete banco[nome];
                salvarBanco(banco);
                renderizarDashboard();
            }
        }

        function exportarExcel() {
            const banco = obterBanco();
            let csv = "data:text/csv;charset=utf-8,\uFEFFResidente;Data;IMC;ICN;Status\n";
            
            Object.keys(banco).forEach(nome => {
                banco[nome].avaliacoes.forEach(a => {
                    csv += `${nome};${a.data};${a.imc};${a.icn};${a.classIcn}\n`;
                });
            });

            const link = document.createElement("a");
            link.setAttribute("href", encodeURI(csv));
            link.setAttribute("download", "relatorio_nutricional_lar.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
