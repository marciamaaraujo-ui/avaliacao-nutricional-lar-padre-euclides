<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Relatório Executivo</title>
<link rel="stylesheet" href="style.css">
<script src="app.js"></script>
</head>

<body>

<script>
const senha=prompt("Senha Direção:");
if(senha!=="direcao123"){
    alert("Acesso negado");
    window.location.href="dashboard.html";
}
</script>

<div class="navbar">
<div class="navbar-inner">
<img src="logo.png" class="logo">
<div class="links">
<a href="dashboard.html">Dashboard</a>
</div>
</div>
</div>

<div class="container">

<h1>Relatório Executivo Institucional</h1>

<div id="conteudo"></div>

</div>

<script>

const dados = obterRegistros();

let total = dados.length;
let alto = dados.filter(r=>r.classificacao==="Alto Risco Clínico").length;
let moderado = dados.filter(r=>r.classificacao==="Risco Moderado").length;
let baixo = dados.filter(r=>r.classificacao==="Baixo Risco").length;

let pctAlto = total>0 ? (alto/total)*100 : 0;

let metaStatus = pctAlto < 15 ? "Meta institucional atingida (<15%)."
               : "Meta institucional NÃO atingida.";

let tendencia = "Estável";

if(total>=2){
    const ultimo = dados[dados.length-1].icn;
    const anterior = dados[dados.length-2].icn;

    if(ultimo>anterior) tendencia="Piora clínica recente.";
    if(ultimo<anterior) tendencia="Melhora clínica recente.";
}

document.getElementById("conteudo").innerHTML = `
<p><strong>Total de Avaliações:</strong> ${total}</p>
<p><strong>Alto Risco:</strong> ${alto}</p>
<p><strong>Risco Moderado:</strong> ${moderado}</p>
<p><strong>Baixo Risco:</strong> ${baixo}</p>
<p><strong>% Alto Risco:</strong> ${pctAlto.toFixed(1)}%</p>
<p><strong>Meta Institucional:</strong> ${metaStatus}</p>
<p><strong>Tendência:</strong> ${tendencia}</p>
`;

</script>

</body>
</html>
